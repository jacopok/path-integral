\documentclass[main.tex]{subfiles}
\begin{document}

\section{Before the PI}

\subsection{Schrödinger, Heisenberg \& interaction}

We denote \(U = \exp(Ht/i \hbar) \), and similarly with \(H_0 \rightarrow U_0 \), \(V \rightarrow U_V\).

\paragraph{Schrödinger}

\begin{enumerate}
    \item State kets are \(\ket{\psi (t)} = U \ket{\psi (t = 0)}  \);
    \item observables are \(A(t) \equiv A(t=0)\);
    \item base kets are defined by \(A \ket{a} = a \ket{a} \), therefore \(\ket{a(t)} \equiv \ket{a(t=0)} \).
\end{enumerate}

\paragraph{Heisenberg}

\begin{enumerate}
    \item State kets are \(\ket{\psi (t)} \equiv \ket{\psi (t=0)} \);
    \item observables are \(A(t) = U ^\dag A(t=0) U \);
    \item base kets are \(\ket{a(t)} = U ^\dag \ket{a(t=0)} \).
\end{enumerate}
    

\paragraph{Interaction}

We denote by a subscript \(S\) or \(I\) objects in the Schrödinger or interaction system. In the 

\begin{enumerate}
    \item State kets are defined as \(\ket{\psi (t)}_I = U_0 ^\dag \ket{\psi (t)}_S \);
    \item observables are defined as \(A_I (t) = U_0 ^\dag A_S U_0 \);
    \item as base kets we use eigenstates of \(H_0 \): \(H_0 \ket{n} = E_n \ket{n} \). These evolve like \(\ket{n(t)} = U_0 \ket{n(t= 0)} \).
\end{enumerate}

Then, we can generically write the evolution of a Schrödinger ket as 
%
\begin{equation}
  \ket{\psi (t)}_S = 
  \sum _{n}  c_n(t) \exp(E_n t / i \hbar) \ket{n}
\,,
\end{equation}
%
therefore the evolution of the interaction ket is 
%
\begin{equation}
    \ket{\psi (t)}_I = 
    U_0 ^\dag \ket{\psi (t)} _S = \sum _n c_n (t) \ket{n} 
\,.
\end{equation}

We can write an equation for the evolution of the \(c_n(t)\): 
%
\begin{equation}
  i \hbar \dot{c_n} (t) = \sum_m V_{nm} \exp(i \omega_{nm} t) c_m(t) 
\,,
\end{equation}
%
where \(\omega_{nm} = (E_n - E_m) / \hbar\) and \(V_{nm} = \bra{n} V \ket{m} \). This is a matrix equation for the coefficient vector. 

\paragraph{Time-dep perturbations}

If we define the interaction-picture evolution operator as \(\ket{\alpha, t}  = U_I (t) \ket{\alpha, 0} \) we have its evolution as \(i \hbar \partial_t U_I = V_I U_I\).

For small times \(U_I \approx \mathbb{1}\), so we can integrate the Schrödinger equation: 
%
\begin{subequations}
    \begin{align}
        U_I &= \mathbb{1} + \frac{1}{i \hbar} \int_0^t V_I(t') U_I(t') \dd{t'}  \\
        &= \mathbb{1} + \frac{1}{i \hbar}\int_0^t V_I(t')\qty(
            \mathbb{1} + \frac{1}{i \hbar} \int_0^{t'} V_I(t'') U_I(t'') \dd{t''}
        ) \dd{t'}  \\
        &= \mathbb{1} + \frac{1}{i \hbar}\int_0^t V_I(t') \dd{t'} + \frac{1}{(i \hbar)^2} \int_0^t \int_0^{t'}V_I(t')V_I(t'') \dd{t'} \dd{t''} + o(V_I^2)
\end{align}
\,.
\end{subequations}
%

Now, if we start on a base ket \(\ket{i} \), the evolution coefficients \(c_n(t)\) will be given by the matrix elements \(\bra{n} U_I (t) \ket{i} \).
We can compute these to any order in \(V_I\), by taking the components of the previous equation and applying the following computation any time we have the components of \(V_I\): 
%
\begin{equation}
  \bra{n} V_I \ket{i} = \bra{n} U_0 ^\dag V U_0 \ket{i} = \exp(i \omega_{ni} t) V_{ni} 
\,,
\end{equation}
%
since the \(\ket{n} \) are eigenstates of the unperturbed Hamiltonian. 

\subsection{The propagator}

If \(H \ket{\alpha '} = \alpha ' \ket{\alpha '} \), then the evolution operator can be decomposed as 
%
\begin{equation}
  U (t) = \sum _{\alpha '} \exp(\frac{E_{\alpha '} t}{i \hbar}) \dyad{\alpha '}  
\,.
\end{equation}

This can be written in the position basis as a Green function by contracting with two position vectors: 
%
\begin{equation}
  \bra{x'} U(t) \ket{x''} =
  \sum _{\alpha '} \exp(\frac{E_{\alpha '} t}{i \hbar}) \braket{x'}{\alpha '} \braket{\alpha '}{x''} 
  \overset{\text{def}}{=}  K(x', x''; t)
\,,
\end{equation}
%
and with this we can directly compute the evolution at a generic time: \(\psi (x'', t) =  \int \dd[3]{x'} K(x'', x'; t) \psi (x')\). It is effectively the transition amplitude: \(K = \braket{x'', t}{x', 0} \) when seen in the Heisenberg picture (since we are evolving a base ket).

\begin{enumerate}
    \item \(K(x', x'', t)\) satisfies the Schrödinger equation, since it is a sum of terms which do;
    \item \(\lim_{t \rightarrow 0} K(x', x'', t) = \delta^3 (x', x'')\).
\end{enumerate}

\subsection{Some useful propagators}

\paragraph{Free particle}

We consider \(H = p^2/2m\); the momentum eigenstates are \(p \ket{p'} = p' \ket{p'} \), and they are also energy eigenstates with \(H \ket{p'}  = ((p')^2/2m) \ket{p'} \).

We compute: 
%
\begin{equation}
  K(x', x'', t) = \int \dd{p'} \braket{x''}{p'} \braket{p'}{x'} \exp(\frac{(p')^2 t}{i \hbar 2m }) 
\,,
\end{equation}
%
and recall that \(\braket{x}{p} = \exp(-px/ i \hbar) / \sqrt{2 \pi \hbar}  \). We simplify the exponent to get a Gaussian integral: it is known that
%
\begin{equation}
  \int _{\mathbb{R}} \dd{x} \exp(- i \alpha x^2) = \sqrt{\frac{\pi}{i \alpha }} 
\,,
\end{equation}
%
therefore in the end we get: 
%
\begin{equation}
  K(x', x'', t) = \frac{1}{2 \pi \hbar} \exp(\frac{im (x'' - x')^2}{2 \hbar t}) \sqrt{\frac{2 m \pi \hbar}{it}} 
\,,
\end{equation}
%
which for \(t \rightarrow 0\) is in the form
\(\exp({(x' - x'')}^2/t) \sqrt{t} \rightarrow \delta (x''- x') \).

\paragraph{Harmonic oscillator}

We consider \(H = p^2/2m + m \omega^2 x^2 / 2\). It is known that the eigenfunctions are given by the Hermite polynomials: 
%
\begin{equation}
  \braket{x'}{n} = \frac{1}{\pi^{1/4} \sqrt{2^{n} n!}} \frac{1}{x_0^{1/2}} H_n y \exp(-\frac{(x/x_0)^2}{2}) 
\,,
\end{equation}
%
where \(x_0 = \sqrt{\hbar / (m \omega )} \) (both masses and frequencies are inverse lengths in natural units!). We also know the eigenenergies, \(E_n = \hbar \omega (n+1/2)\). We can then compute away, to finally get: 
%
\begin{equation}
  K = \sqrt{\frac{m \omega }{2 i \pi \hbar \sin(\omega t))}}
  \exp(\frac{im \omega \qty(((x'')^2+(x')^2)\cos(\omega t)-2x'x'' )}{2 \hbar \sin(\omega t) })  
\,.
\end{equation}
%

\section{The Path Integral}

We can time-slice the interval between a certain time \(0 = t_0\) and another time \(t = t_N\) in \(N\) parts. Then, evolving the system with a the propagator for each one, we get: 
%
\begin{equation}
  K(x_N, x_0, t) = 
  \int \qty(\prod _{i=1}^{N-1} \dd[]{x_i}) \qty(\prod_{i=0}^{N-1}\braket{x_{i+1}, t_{i+1}}{x_i, t_i})  
\,.
\end{equation}

We call the time-slice \(\epsilon = t/N\). We will expand the in \(\epsilon \) up to first order the evolution operator \(\exp(H \epsilon /i \hbar) \).

The braket \(\braket{x_{i+1}, t_{i+1}}{x_{i}, t_{i}} \), if we assume \(t_{i+1} - t_i = \epsilon \), can be written as 
%
\begin{equation}
  \bra{x_{i+1}} \exp(\frac{H \epsilon }{i \hbar}) \ket{x_i}
\,.
\end{equation}

The first case we consider is a free particle Hamiltonian, \(X = p^2/2m + V(x)\); we insert a momentum completeness 
%
\begin{equation}
  \bra{x_{i+1}} \exp(\frac{H \epsilon }{i \hbar}) \ket{x_i}
  = \int  \dd{p'} \braket{x_{i+1}}{p'} \bra{p'} 
  \exp(\frac{H \epsilon }{i \hbar}) \ket{x_i}   
\,,
\end{equation}
%
and now make a 

\begin{claim}
\begin{equation}
  \bra{p'} 
  \exp(\frac{H \epsilon }{i \hbar}) \ket{x_i}
  = \exp(\frac{\epsilon }{i \hbar} \qty(p^{\prime 2}/2m + v(x_{i}))) + O(\epsilon^{3/2})
\,.
\end{equation}
\end{claim}

\begin{proof}
  We rewrite the expression as 
  %
  \begin{equation}
    \bra{p^{\prime }} \exp(\epsilon (T+U)) \ket{x}  
  \,,
  \end{equation}
  %
  where \(T = \frac{p^2/2m}{ i \hbar} \), \(U = \frac{V}{i \hbar}\).
  If we multiply and divide by \(e^{\epsilon U}\) (respectively \(T\)) we get that proving our identity is equivalent to proving that: 
  %
  \begin{equation}
    \bra{p} \exp(-\epsilon T) \exp(\epsilon H / i \hbar) \exp(-\epsilon U) \ket{x}  = \braket{p'}{x} 
  \,,
  \end{equation}
  %
  and we call the product of exponentials \(\exp(-\epsilon^2 C) \).

  The CBH formula yields a solution \(C\) to the equation \(e^{C}= e^{A}e^{B}\) in terms of commutators of \(A\) and \(B\).
  With it, we arrive at:  
  %
  \begin{equation}
    \exp(-\epsilon^2 C) = \exp(- \frac{\epsilon^2}{2} [T, U] + O(\epsilon^3)) 
  \,,
  \end{equation}
  %
  but the term \([T, U]\) is not of constant order with respect to \(\epsilon \): the range of \(p\) which must be considered when integrating is of the order \(\epsilon^{-1/2}\), and \([T, U] \sim p\). So the term is actually of order \(\exp(-\epsilon^{3/2}) \). When raising it to the power \(N \sim 1/ \epsilon \) we get 
  %
  \begin{equation}
    \qty(1 + \epsilon^{3/2})^{1/\epsilon } \sim 1 
  \,,
  \end{equation}
  %
\end{proof}

Then, using the fact that \(\braket{x}{p} = \exp(-xp/i\hbar) / \sqrt{2 \pi \hbar} \), we get: 


%
\begin{subequations}
\begin{align}
  &\int  \dd{p'} \braket{x_{i+1}}{p'} \bra{p'} 
  \exp(\frac{H \epsilon }{i \hbar}) \ket{x_i} =  \\
  &= \frac{1}{2 \pi \hbar} \int  \dd{p^{\prime }} 
  \exp(-\frac{\qty(x_{i+1}-x_{i})p^{\prime }}{i \hbar}) 
  \exp(\frac{\epsilon }{i \hbar}\qty(\frac{p^{\prime 2}}{2m} - V(x_{i})))  \\
  &= \frac{1}{2 \pi \hbar}
  \int  \dd{p^{\prime }} \exp(\frac{\epsilon}{i \hbar} \qty(H(p^{\prime}, x ) - \dot{x} p^{\prime }))
  \,,
\end{align}
\end{subequations}
%
and now we can define the new variable \(\widetilde{p} = p^{\prime } - m \dot{x}\) we have \(\widetilde{p}^2/2m - m \dot{x}^2 /2 = p^{\prime 2} /2m - \dot{x} p^{\prime }\), therefore the integral becomes Gaussian in \(\widetilde{p}\): 
%

%
\begin{subequations}
\begin{align}
  &\frac{1}{2 \pi \hbar} \int  \dd{\widetilde{p}} 
  \exp(\frac{\epsilon}{i \hbar} \qty(\frac{\widetilde{p}^2 }{2m} - \frac{m \dot{x}^2}{2} + V(x))) =  \\
  &= \frac{1}{2 \pi \hbar} \sqrt{\frac{2 \pi m \hbar }{i \epsilon }} \exp(- \epsilon  \frac{L(x, \dot{x})}{i \hbar}) \\
  &=  \sqrt{\frac{ m  }{2 \pi i \hbar \epsilon }} \exp(- \epsilon  \frac{L(x, \dot{x})}{i \hbar}) = \braket{x_{i+1}, t_{i+1}}{x_{i}, t_{i}}
  \,,
\end{align}
\end{subequations}

but 

\subsection{Path integral of a quadratic Lagrangian}

Let \(L(x,\dot{x})\) be a quadratic Lagrangian:
\begin{equation}
  L = a\dot{x}^2 + bx\dot{x} + cx^2 + d\dot{x} + ex + f
  \,.
\end{equation}

The propagator for $L$, computed via path integral, is:
%
\begin{subequations}
  \begin{align}
    K &= \int\DD{x} \exp(\frac{i}{\hbar}\int \dd{t} L) \\
    &= \int\DD{x} \exp(\frac{i}{\hbar}\int \dd{t} ( \underbrace{a\dot{x}^2 + bx\dot{x} + cx^2 + d\dot{x} + ex + f}_F) )
    \,.
  \end{align}
\end{subequations}

Let $x_c$ be the classical path; let's write $x = x_c + y$ and therefore $\DD{x} = \DD{y}$. Properly replacing $x$ and $\dot{x}$, the propagator can be written as:
%
\begin{subequations}
\begin{align}
\begin{split}
F &= a (\dot{x}_c^2+\dot{y}^2+2\dot{x}_c\dot{y}) + b(x_c\dot{x}_c+x_c\dot{y}+y\dot{x}_c+y\dot{y}) + c(x_c^2+y^2+2x_cy) +\\&\qquad+ d(\dot{x}_c+\dot{y}) + e(x_c+y) + f
\end{split} \\
\begin{split}
&= (a\dot{x}_c^2+bx_c\dot{x}_c+cx_c^2+d\dot{x}_c+ex_c+f) + (a\dot{y}^2 + by\dot{y} + cy^2) + \\&\qquad + \dot{y} ( 2a\dot{x}_c + bx_c + d ) +y (b\dot{x}_c + 2cx_c + e) \end{split}\\
&= L_c + (a\dot{y}^2 + by\dot{y} + cy^2) + \dot{y} \eval{\pdv{L}{\dot{x}}}_{x_c} + y \eval{\pdv{L}{x}}_{x_c}
\,,
\end{align}
\end{subequations}
%
and so
%
\begin{align}
K &= \int\DD{y} \exp( \frac{i}{\hbar}\int \dd{t} \left( L_c + (a\dot{y}^2 + by\dot{y} + cy^2) + \dot{y} \eval{\pdv{L}{\dot{x}}}_{x_c} + y \eval{\pdv{L}{x}}_{x_c} \right) )
\,.
\end{align}

Evaluating by parts the last part of the integral:
%
\begin{align}
I &= \int \dd{t} \left( \dot{y} \eval{\pdv{L}{\dot{x}}}_{x_c} + y \eval{\pdv{L}{x}}_{x_c} \right) \\
&= \eval{y}_i^f \eval{\pdv{L}{\dot{x}}}_{x_c} + \int \dd{t} \left( -y \left( \eval{\dv{t}\pdv{L}{\dot{x}}}_{x_c} - \eval{\pdv{L}{x}}_{x_c} \right) \right)
\end{align}
that, by the equation of motion and the definition of $y$, is 0. Therefore,
\begin{align}
K &= e^{\frac{i}{\hbar} S_c }\int \DD{y} \exp( \frac{i}{\hbar} \int \dd{t} (a\dot{y}^2 + by\dot{y} + cy^2) )
\end{align}
Only the quadratic terms contribute to the propagator prefactor; the linear terms affect only the classical action computing.

\section{Adding a source term to the action}
\subsection{The free particle case}
Let's suppose to have a free particle, and let's add a source term:
\begin{equation}
L = \frac{m}{2} \dot{x}^2 + Jx
\end{equation}
As showed for the quadratic Lagrangians, the source factor affect only the classic action term:
\begin{equation}
K =  e^{\frac{i}{\hbar} S_c }\int \DD{y} \exp( \frac{i}{\hbar} \int \dd{t} (\frac{m}{2}\dot{y}^2) )
\end{equation}
and, remembering the already computed path integral for free particle,
\begin{equation}
K = \sqrt{\frac{m}{2\pi i \hbar (t_f-t_i)}} e^{\frac{i}{\hbar} S_c }
\end{equation}

\subsection{Generic Lagrangian and functional derivatives}
Let $L$ be a generic Lagrangian, and let's add a source term
\begin{equation}
L' = L + Jx
\end{equation}
where $J=J(t)$. Considering time and space quantized, the propagator is:
\begin{equation}
K = \int \dd{x_1}\dots\dd{x_n} \exp(\frac{i}{\hbar} \sum_i (L(\dot{x}_i,x_i) + J_i x_i) )
\end{equation}
Deriving $K$ by a generic $J_i$,
\begin{equation}
\pdv{K}{J_i} = \frac{i}{\hbar}\int \DD{x} x_i \exp( \frac{i}{\hbar} \sum_i (L(\dot{x}_i,x_i) + J_i x_i) ) 
\end{equation}
and going to the continuous limit,
\begin{equation}
\fdv{K[J]}{J(t^*)} = \frac{i}{\hbar}\int \DD{x} x(t^*) \exp(\frac{i}{\hbar} \int \dd{t} (L(\dot{x},x) + J x) )
\end{equation}
where $\fdv{K[J]}{J(t^*)}$ is the functional derivative.

To find the meaning of this expression the path integral can be split in three integral, wrt the position at time $t^*$. Let $\DD{x_{i*}}$ be the differential on all the path from $x_i$ to $x^*$, and $\DD{x_{*f}}$ be the differential on all the path from $x^*$ to $x_f$. So:
\begin{align}
\fdv{K[J]}{J(t^*)} &= \frac{i}{\hbar}\int \DD{x} x(t^*) \exp(\frac{i}{\hbar} \int \dd{t} (L(\dot{x},x) + J x) ) \\
				   &= \frac{i}{\hbar}\int \DD{x_{i*}} \dd{x^*} \DD{x_{*f}} x^* \exp(\frac{i}{\hbar} \left(\int_{t_i}^{t^*} + \int_{t^*}^{t_f} \right) \dd{t} (L(\dot{x},x) + J x) ) \\
				   &= \frac{i}{\hbar}\int \dd{x^*} K(f,*) x^* K(*,i)
\end{align}
Remembering that $K(f,i) = \braket{x_f,t_f}{x_i,t_i}$:
\begin{align}
\fdv{K[J]}{J(t^*)} &= \frac{i}{\hbar}\int \dd{x^*} \braket{x_f,t_f}{x^*,t^*} x^* \braket{x^*,t^*}{x_i,t_i} \\
	&= \frac{i}{\hbar}\int \dd{x^*} \mel{x_f}{e^{-\frac{i}{\hbar}H(t_f-t^*)}}{x^*} x^* \mel{x_*}{e^{-\frac{i}{\hbar}H(t^*-t_i)}}{x_i}
\end{align}
Therefore, having $\int \dd{x} \ket{x} x \bra{x} = \hat{x}$:
\begin{align}
\fdv{K[J]}{J(t^*)} &= \frac{i}{\hbar}\bra{x_f} e^{-\frac{i}{\hbar}H(t_f-t^*)} \hat{x}^* e^{-\frac{i}{\hbar}H(t^*-t_i)} \ket{x_i} \\
	&= \frac{i}{\hbar}\bra{x_f,t_f} \hat{x}(t^*) \ket{x_i,t_i}
\end{align}
that means, the functional derivative allow us to compute the expectation value for $\hat{x}$ at a fixed time $t^*$.

\subsection{Smart way to solve perturbed harmonic oscillator}
Let's consider a perturbed harmonic oscillator:
\begin{equation}
L = \underbrace{\frac{m}{2}\dot{x}^2 + \frac{m}{2}\omega^2x^2}_{L_{HO}} - \lambda x^4
\end{equation}

To solve the path integral, let's add a source term to the Lagrangian and compute $K[J]$:
\begin{align}
K[J] &= \int \DD{x} \exp( \frac{i}{\hbar} \int \dd{t} (L_{HO} - \lambda x^4 + Jx ) ) \\
&= \int \DD{x} \exp{ -\frac{i}{\hbar} \int \dd{t} \lambda x^4} \exp( \frac{i}{\hbar} \int \dd{t} (L_{HO} + Jx ) ) \\
&= \int \DD{x} \sum_n \frac{1}{n!} \left( -\frac{i\lambda}{\hbar} \int \dd{t} x^4 \right)^n \exp( \frac{i}{\hbar} \int \dd{t} (L_{HO} + Jx ) ) \\
&= \sum_n \frac{1}{n!} \left( -\frac{i\lambda}{\hbar} \right)^n \int \DD{x} \dd{t_1} \dots \dd{t_n} x_1^4 \dots x_n^4 \exp( \frac{i}{\hbar} \int \dd{t} (L_{HO} + Jx ) ) \\
&= \sum_n \frac{1}{n!} \left( -\frac{i\lambda}{\hbar} \right)^n \frac{\hbar^4}{i^4}\fdv[4]{J_1}\dots\frac{\hbar^4}{i^4}\fdv[4]{J_n} \int \DD{x} \exp( \frac{i}{\hbar} \int \dd{t} (L_{HO} + Jx ) ) \label{eqn:halfpertho}
\end{align}
where when writing a product that involves a functional derivative the time integral is understood, i.e.
\begin{equation}
\pdv{F[J]}{J} y = \int \dd{t} \pdv{F[J]}{J(t)} y(t)
\end{equation}
In the equation \eqref{eqn:halfpertho} can be recognized the path integral for the un-perturbed harmonic oscillator:
\begin{align}
K[J] &= \sum_n \frac{1}{n!} \left( -i\lambda\hbar^3 \right)^n \fdv[4]{J_1}\dots\fdv[4]{J_n} K_{HO}[J]
&= \exp( -i\lambda\hbar^3 \fdv[4]{J} ) K_{HO}[J]
\end{align}

Finally, to return to the initial problem without source term, is enough to compute everything in $J=0$:
\begin{equation}
K = \eval{ \exp( -i\lambda\hbar^3 \fdv[4]{J} ) K_{HO}[J] }_{J=0}
\end{equation}

% Timeslicing \& introduction of the PI (JJJ)

% Trotter product formula (JJ)

% Classical path decomposition in the PI (JJ)

% Orders of magnitude (JJJ)

% Schrödinger equation from the PI (GIO)

% PI for quadratic Lagrangians (LEO)

% Math appendix: (complex) gaussian integrals (JJ)

% PI for the harmonic oscillator (GIO in caso)

% PI for general lagrangians (nonquadratic) ()

% Math appendix: functional derivatives (JJ)

% Semiclassical approximation (ALBE)

% Operator Matrix Elements (J)

% Adding a source term to the action (LEO)

% Application to the forced harmonic oscillator (LEO)

% Perturbation theory ()

% Imaginary time \& the Euclidean PI (ALE)

% Instantons (FRANCÉ)

% Kinks (J)



\end{document}

